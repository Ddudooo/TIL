# 콜백

자바스크립트 호스트 환경이 제공하는 여러 함수를 사용하면 `비동기(asynchronous)` 동작을 스케줄링 할 수 있다.

`setTimeout`은 스케줄링에 사용되는 가장 대표적인 함수입니다.

이러한 비동기 동작의 끝에 추가적인 동작을 해야할때 

사용되는 패턴이 `콜백(callback)` 패턴이다.

비동기 메서드에서 콜백 함수를 호출하는 식으로 구현되는 패턴으로

콜백 함수를 통해 비동기 동작 이후 작업을 진행할 수 있다.

## 콜백 속 콜백

콜백 패턴을 통해 비동기 로직을 사용하다 보면

하나의 콜백으로 처리되는 경우가 있지만 

여러 로직이 연결되어 사용되는 경우가 잦다.

이러한 로직을 콜백 패턴으로 구현하게 될 경우

콜백 지옥이라 불리는 콜백이 콜백을 부르고 콜백이 콜백을 부르는...

가독성과 디버깅의 간편함을 모두 포기하는 상황이 된다.

해당 내용에 대한 해결법은 다른 비동기 함수 작성법인 `Promise`를 통해 해결할 수 있다.

## 에러 핸들링

콜백 패턴을 통해 구현했을 경우

해당 로직이 실패 했을때에도 추가적이 로직이 필요한 경우가 있다.

이 실패에 대한 로직 또한 콜백 패턴으로 구현하면 된다.

주로 비동기 함수가 실패를 던질 경우,

해당 함수가 예외가 발생했나를 확인을 먼저한 뒤, 정상로직의 콜백을 호출한다.

`오류 우선 콜백`으로 불리는데

1. `callback`의 첫 번째 인수는 에러를 위해 남긴다.  
에러가 발생하면 이 인수를 이용해 `callback(err)`이 호출됩니다.
2. 두 번째 인수(필요하면 인수를 더 추가할 수 있음)는 에러가 발생하지 않았을 때를 위해 남긴다.  
원하는 동작이 성공한 경우엔 `callback(null, result1, result2...)`이 호출됩니다.

오류 우선 콜백 스타일을 사용하면, 단일 콜백 함수에서 에러 케이스와 성공 케이스 모두를 처리할 수 있다.

---

콜백을 통한 비동기 처리의 경우, 옛날 방식이므로 단점(주로, 콜백 지옥)을 해결한 `Promise`를 통한 비동기 처리를 하도록 하자.